<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard de Contratos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="mb-4">üìÑ Contratos Pendentes</h2>

    <button onclick="alternarTema()" class="btn btn-outline-secondary mb-4">
      üåô Alternar tema
    </button>

    <table class="table table-bordered bg-white shadow-sm">
      <thead class="table-light">
        <tr>
          <th>Nome</th>
          <th>Servi√ßo</th>
          <th>Empresa</th>
          <th>A√ß√£o</th>
        </tr>
      </thead>
      <tbody id="tabela-contratos">
        <!-- Linhas geradas dinamicamente -->
      </tbody>
    </table>

    <div id="alerta" class="alert d-none mt-3" role="alert"></div>
  </div>

  <script>
    const contratos = [
      {
        nome: "Abdiel Marins",
        servico: "Social Media",
        empresa: "Ag√™ncia Tribo",
        id: "Abdiel_Marins"
      }
    ];

    const tabela = document.getElementById("tabela-contratos");

    contratos.forEach(c => {
      const linha = document.createElement("tr");
      linha.innerHTML = `
        <td>${c.nome}</td>
        <td>${c.servico}</td>
        <td>${c.empresa}</td>
        <td>
          <a href="/aprovar?id=${c.id}" class="btn btn-success btn-sm btn-aprovar">
            <i class="bi bi-check-circle"></i> Aprovar
          </a>
        </td>
      `;
      tabela.appendChild(linha);
    });

    document.querySelectorAll('.btn-aprovar').forEach(botao => {
      botao.addEventListener('click', async (e) => {
        e.preventDefault();
        const url = botao.getAttribute('href');

        try {
          const resposta = await fetch(url);
          const texto = await resposta.text();

          mostrarAlerta(texto, 'success');
        } catch (erro) {
          mostrarAlerta('‚ùå Erro ao aprovar contrato.', 'danger');
        }
      });
    });

    function mostrarAlerta(mensagem, tipo) {
      const alerta = document.getElementById('alerta');
      alerta.textContent = mensagem;
      alerta.className = `alert alert-${tipo} mt-3`;
    }

    function alternarTema() {
      document.body.classList.toggle('bg-dark');
      document.body.classList.toggle('text-light');
    }
  </script>
</body>
</html>
